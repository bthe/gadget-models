{
    "contents" : "library(Rgadget)\n## populate the model with sane defaults\nopt <- gadget.options(type='simple2stock')\n\n## adapt to Cod\nweight.alpha <- 6.5e-6\nweight.beta <- 3.07\n\nopt$area$numofareas <- 1\nopt$time$firstyear <- 1960\nopt$time$lastyear <- 2015\n\n## immature stock\nopt$stocks$imm <-\n  within(opt$stocks$imm,{\n    name <- 'codimm'\n    minage <- 1\n    maxage <- 10\n    minlength <- 4\n    maxlength <- 130\n    dl <- 2\n    growth <- c(linf='#Linf',k='( * 0.001 #k)',\n                beta='(* 10 #bbin)', binn=15,recl='#recl')\n    weight <- c(a=weight.alpha, b=weight.beta)\n    init.abund <- sprintf('(* %s %s)',c(0,0.1,0.1,0.08,0.06,0.04,0.02,0.01,0,0),\n                          c(0,sprintf('#age%s',2:8),0,0))\n    n <- sprintf('(* 1000 #rec%s)',1960:2015)\n    doesmature <- 1\n    maturityfunction <- 'continuous'\n    maturestocksandratios <- 'codmat 1'\n    maturity.coefficients <- '( * 0.001 #mat1) #mat2 0 0'\n      \n      #list(alpha='( * 0.001 #mat1)',\n                            #      l50='#mat2', beta=0,\n                            #      a50=0)\n    M <- c(0.5,  0.35, 0.2, 0.2,  0.2, 0.2, 0.2, 0.2, 0.2, 0.3)\n    maturitysteps <- '0'\n    doesmove <- 1\n    transitionstep <- 4\n    transitionstocksandratios <- \"codmat 1\"\n    doesmigrate <- 0\n    doesrenew <- 1\n    renewal <- list(minlength=4, maxlength=28)\n  })\n\n\n## mature stock\nopt$stocks$mat <-\n  within(opt$stocks$mat,{\n    name <- 'codmat'\n    minage <- 3\n    maxage <- 12\n    minlength <- 20\n    maxlength <- 140\n    dl <- 2\n    M <- c(0.2,  0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.3, 0.5, 0.7)\n    growth <- c(linf='#Linf',k='( * 0.001 #k)',\n                beta='(* 10 #bbin)', binn=15,recl='#recl')\n    weight <- c(a=3.5e-6, b=3.22)\n    init.abund <- sprintf('(* %s %s)',c(0,0.02,0.04,0.06,0.08,0.09,0.01,0.001,0.0001,0),\n                          c(0,sprintf('#age%s',4:11),0))\n    doesmature <- 0\n    doesmigrate <- 0\n  })\n\n\n## create the gadget skeleton\ngm <- gadget.skeleton(time=opt$time, area=opt$area,\n                      stocks=opt$stocks,opt$fleets)\n\ngm@stocks$imm@initialdata$area.factor <- '( * 100 #mult)'\ngm@stocks$mat@initialdata$area.factor <- '( * 100 #mult)'\n\ngm@fleets <- list(old.fleet,igfs.fleet,aut.fleet,lln.fleet,gil.fleet,bmt.fleet,foreign.fleet)\nRgadget:::gadget_dir_write(as.list(gd),gm)\n\nsetwd(gd$dir)\ncallGadget(s=1,ignore.stderr = FALSE)\n\ninit.params <- read.gadget.parameters('params.out')\n\ninit.params[c('Linf','k','bbin','mult',grep('age',rownames(init.params),value=TRUE),'mat1','mat2'),] <- \n  read.table(text='switch\tvalue\t\tlower\tupper\toptimise\nLinf\t         160\t      80     2000        0\nk\t          90\t       1      200        1\nbbin\t         6\t   1e-08    100        1\nmult\t         1000\t     0.1      1000        1\nage2\t         35\t    0.01     150        1\nage3\t         25\t    0.01     120        1\nage4\t         15\t   0.001     100        1\nage5\t          7\t  0.0001     100        1\nage6\t          7\t   1e-05     100        1\nage7\t          5\t   1e-08     100        1\nage8\t          5\t   1e-10     100        1\nage9\t         25\t   1e-12     100        1\nage10\t         10\t   1e-15     100        1\nage11\t         10\t   1e-15    1e+05        1\nmat1\t          70\t      10      200        1\nmat2\t          70\t      30      100        1',header=TRUE)\n\ninit.params$switch <- rownames(init.params)\n\ninit.params[grepl('rec[0-9]',init.params$switch),'value'] <- 30\ninit.params[grepl('rec[0-9]',init.params$switch),'upper'] <- 200\ninit.params[grepl('rec[0-9]',init.params$switch),'lower'] <- 0.01\ninit.params[grepl('rec[0-9]',init.params$switch),'optimise'] <- 1\n\ninit.params['recl',-1] <- c(12, 4, 20,1)\n\n\ninit.params[grepl('alpha',init.params$switch),'value'] <- 0.5\ninit.params[grepl('alpha',init.params$switch),'upper'] <- 3\ninit.params[grepl('alpha',init.params$switch),'lower'] <- 0.01\ninit.params[grepl('alpha',init.params$switch),'optimise'] <- 1\n\ninit.params[grepl('l50',init.params$switch),'value'] <- 50\ninit.params[grepl('l50',init.params$switch),'upper'] <- 100\ninit.params[grepl('l50',init.params$switch),'lower'] <- 20\ninit.params[grepl('l50',init.params$switch),'optimise'] <- 1\n\nwrite.gadget.parameters(init.params,file='params.in')\n",
    "created" : 1435852968037.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1220732473",
    "id" : "E76D6D92",
    "lastKnownWriteTime" : 1435941601,
    "path" : "~/Dropbox/gadget-models/01-cod/00-data/setup-model.R",
    "project_path" : "setup-model.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}